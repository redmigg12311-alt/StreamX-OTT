<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>StreamX Admin Panel</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{font-family:'Space Grotesk',sans-serif;background:#f0f4ff;min-height:100vh;display:flex;flex-direction:column;}
.card{background:#fff;border-radius:1rem;box-shadow:0 10px 25px rgba(0,0,0,0.05);}
input,textarea,select{border:1px solid #e5e7eb;background:#f9fafb;color:#374151;}
input:focus,textarea:focus,select:focus{border-color:#6366f1;outline:none;box-shadow:0 0 0 2px rgba(99,102,241,0.2);}
.btn{background:#6366f1;color:white;}
.btn:hover{background:#4f46e5;}
.tab-btn-active{background:#6366f1!important;color:white!important;}
.alert{position:fixed;top:1rem;right:1rem;z-index:50;padding:.75rem 1.25rem;border-radius:.5rem;font-weight:600;}
</style>
</head>
<body class="flex flex-col">

<header class="bg-gray-900 text-white p-4 flex justify-between items-center">
  <h1 class="text-2xl font-bold">StreamX Admin</h1>
  <div class="flex space-x-4 items-center">
    <span id="userEmail"></span>
    <button id="logoutBtn" class="btn px-3 py-1 rounded-md">Logout</button>
  </div>
</header>

<div id="alertBox" class="hidden alert"></div>

<main class="flex-1 p-6">
  <div class="max-w-6xl mx-auto">
    <!-- Login box -->
    <div id="loginBox" class="card p-6 mb-6">
      <h2 class="text-xl font-semibold mb-4">Login (Admin)</h2>
      <form id="loginForm" class="grid gap-3 md:grid-cols-2">
        <input type="email" name="email" placeholder="Admin Email" class="p-2 rounded-md" required>
        <input type="password" name="password" placeholder="Password" class="p-2 rounded-md" required>
        <button class="col-span-2 btn px-4 py-2 rounded-md">Login</button>
      </form>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="hidden">
      <!-- Tabs -->
      <div class="flex space-x-3 justify-center mb-6">
        <button class="tab-btn px-4 py-2 rounded-md bg-gray-100 text-gray-700 tab-btn-active" data-tab="live">Live Channels</button>
        <button class="tab-btn px-4 py-2 rounded-md bg-gray-100 text-gray-700" data-tab="movies">Movies</button>
        <button class="tab-btn px-4 py-2 rounded-md bg-gray-100 text-gray-700" data-tab="series">Series</button>
      </div>

      <!-- Live Channels -->
      <div id="live" class="tab-panel card p-6">
        <h2 class="text-xl font-semibold mb-4">Add Live Channel</h2>
        <form id="liveForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <input name="id" placeholder="ID*" class="p-2 rounded-md" required>
          <input name="name" placeholder="Channel Name" class="p-2 rounded-md">
          <input name="logo" placeholder="Logo URL" class="p-2 rounded-md md:col-span-2">
          <select name="category" class="p-2 rounded-md">
            <option value="">Select Category</option>
            <option>News</option>
            <option>Sports</option>
            <option>Movie</option>
          </select>
          <input name="url" placeholder="Stream URL" class="p-2 rounded-md md:col-span-2">
          <textarea name="description" placeholder="Description" class="p-2 rounded-md md:col-span-2"></textarea>
          <button class="col-span-2 btn px-4 py-2 rounded-md">Add Channel</button>
        </form>
      </div>

      <!-- Movies -->
      <div id="movies" class="tab-panel hidden card p-6">
        <h2 class="text-xl font-semibold mb-4">Add Movie</h2>
        <form id="moviesForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <input name="id" placeholder="ID*" class="p-2 rounded-md" required>
          <input name="title" placeholder="Title *" class="p-2 rounded-md" required>
          <input name="thumbnail" placeholder="Thumbnail URL" class="p-2 rounded-md md:col-span-2">
          <input name="url" placeholder="Stream URL" class="p-2 rounded-md md:col-span-2">
          <textarea name="description" placeholder="Description" class="p-2 rounded-md md:col-span-2"></textarea>
          <button class="col-span-2 btn px-4 py-2 rounded-md">Add Movie</button>
        </form>
      </div>

      <!-- Series -->
      <div id="series" class="tab-panel hidden card p-6">
        <h2 class="text-xl font-semibold mb-4">Add Series</h2>
        <form id="seriesForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <input name="id" placeholder="ID*" class="p-2 rounded-md" required>
          <input name="title" placeholder="Title *" class="p-2 rounded-md" required>
          <input name="thumbnail" placeholder="Thumbnail URL" class="p-2 rounded-md md:col-span-2">
          <input name="banner" placeholder="Banner URL" class="p-2 rounded-md md:col-span-2">
          <textarea name="description" placeholder="Description" class="p-2 rounded-md md:col-span-2"></textarea>
          <button class="col-span-2 btn px-4 py-2 rounded-md">Add Series</button>
        </form>
      </div>
    </div>
  </div>
</main>

<footer class="bg-gray-900 text-white text-center p-3">
  &copy; 2025 StreamX Admin Panel
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

// === CONFIGS ===
// Content project
const contentConfig = {
  apiKey: "AIzaSyCFa9IcxtYMXw0jmLny9m4m9nLEbx6KJcU",
  authDomain: "sample-streamx.firebaseapp.com",
  projectId: "sample-streamx",
  storageBucket: "sample-streamx.firebasestorage.app",
  messagingSenderId: "134980648814",
  appId: "1:134980648814:web:fa817a9c3e239e7755cb7f",
  measurementId: "G-EC6VVWTEG4"
};
// Auth/analytics project
const authConfig = {
  apiKey: "AIzaSyC3gDinL_yG_oO9SRalk4uX5Inp9jn2ZEA",
  authDomain: "streamxlogin-5fddb.firebaseapp.com",
  projectId: "streamxlogin-5fddb",
  storageBucket: "streamxlogin-5fddb.firebasestorage.app",
  messagingSenderId: "194874847275",
  appId: "1:194874847275:web:4d6bb0f280893edb8e7a6e",
  measurementId: "G-2QLZCB09ZC"
};

// === INIT TWO APPS ===
const contentApp = initializeApp(contentConfig,'content');
const contentDB = getFirestore(contentApp);

const authApp = initializeApp(authConfig,'auth');
const auth = getAuth(authApp);

// === UI helpers ===
function showAlert(msg, colorClass){
  const alertBox=document.getElementById('alertBox');
  alertBox.textContent=msg;
  alertBox.className=`alert ${colorClass}`;
  alertBox.classList.remove('hidden');
  setTimeout(()=>alertBox.classList.add('hidden'),3000);
}

// Tabs
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('tab-btn-active'));
    btn.classList.add('tab-btn-active');
    document.querySelectorAll('.tab-panel').forEach(p=>p.classList.add('hidden'));
    document.getElementById(btn.getAttribute('data-tab')).classList.remove('hidden');
  });
});

// Auth login/logout
document.getElementById('loginForm').addEventListener('submit',e=>{
  e.preventDefault();
  const fd=new FormData(e.target);
  signInWithEmailAndPassword(auth,fd.get('email'),fd.get('password'))
  .then(()=>showAlert('Logged in','bg-green-500 text-white'))
  .catch(err=>showAlert(err.message,'bg-red-500 text-white'));
});
document.getElementById('logoutBtn').addEventListener('click',()=>signOut(auth));

onAuthStateChanged(auth,user=>{
  if(user){
    document.getElementById('loginBox').classList.add('hidden');
    document.getElementById('adminPanel').classList.remove('hidden');
    document.getElementById('userEmail').textContent=user.email;
  }else{
    document.getElementById('loginBox').classList.remove('hidden');
    document.getElementById('adminPanel').classList.add('hidden');
    document.getElementById('userEmail').textContent='';
  }
});

// Save content
async function saveData(collectionName,data){
  await setDoc(doc(contentDB,collectionName,data.id),data);
  showAlert(`${collectionName} saved`,'bg-green-500 text-white');
}

document.getElementById('liveForm').addEventListener('submit',async e=>{
  e.preventDefault();
  const data=Object.fromEntries(new FormData(e.target).entries());
  await saveData('channels',data);
  e.target.reset();
});
document.getElementById('moviesForm').addEventListener('submit',async e=>{
  e.preventDefault();
  const data=Object.fromEntries(new FormData(e.target).entries());
  await saveData('movies',data);
  e.target.reset();
});
document.getElementById('seriesForm').addEventListener('submit',async e=>{
  e.preventDefault();
  const data=Object.fromEntries(new FormData(e.target).entries());
  await saveData('series',data);
  e.target.reset();
});
</script>
</body>
</html>
